From: Kairui Song <ryncsn@gmail.com>
Date: Wed, 18 Feb 2026 20:22:54 +0800
Subject: [PATCH] mm-swap-use-the-swap-table-to-track-the-swap-count-fix

fix build

Link: https://lkml.kernel.org/r/aZWuLZi-vYi3vAWe@KASONG-MC4
Signed-off-by: Kairui Song <ryncsn@gmail.com>
Reported-by: kernel test robot <lkp@intel.com>
Closes: https://lore.kernel.org/oe-kbuild-all/202602181835.58TEynxc-lkp@intel.com/
Acked-by: Chris Li <chrisl@kernel.org>
Cc: Baoquan He <bhe@redhat.com>
Cc: Barry Song <baohua@kernel.org>
Cc: David Hildenbrand <david@kernel.org>
Cc: Johannes Weiner <hannes@cmpxchg.org>
Cc: Kairui Song <kasong@tencent.com>
Cc: Kemeng Shi <shikemeng@huaweicloud.com>
Cc: Lorenzo Stoakes <lorenzo.stoakes@oracle.com>
Cc: Nhat Pham <nphamcs@gmail.com>
Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
---
 mm/swapfile.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/mm/swapfile.c b/mm/swapfile.c
index 2777d5b14c2d7..516e142e352e8 100644
--- a/mm/swapfile.c
+++ b/mm/swapfile.c
@@ -1624,7 +1624,7 @@ static int __swap_cluster_dup_entry(struct swap_cluster_info *ci,
 		}
 	} else if (count == SWP_TB_COUNT_MAX) {
 		VM_WARN_ON_ONCE(ci->extend_table[ci_off] >=
-				(BIT(BITS_PER_TYPE(ci->extend_table[0]))) - 1);
+                               type_max(typeof(ci->extend_table[0])));
 		++ci->extend_table[ci_off];
 	} else {
 		/* Never happens unless counting went wrong */
-- 
2.47.3

