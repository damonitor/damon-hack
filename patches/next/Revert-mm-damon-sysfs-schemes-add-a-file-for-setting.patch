From: SeongJae Park <sj@kernel.org>
Date: Thu, 9 Jan 2025 09:25:02 -0800
Subject: [PATCH] Revert "mm/damon/sysfs-schemes: add a file for setting
 damos_filter->pass"

This reverts commit d1f90c2db176c8f9a825c6c7744a478e954aed97.
---
 mm/damon/sysfs-schemes.c | 32 +-------------------------------
 1 file changed, 1 insertion(+), 31 deletions(-)

diff --git a/mm/damon/sysfs-schemes.c b/mm/damon/sysfs-schemes.c
index 9e171046ee94..9a883e8aea1c 100644
--- a/mm/damon/sysfs-schemes.c
+++ b/mm/damon/sysfs-schemes.c
@@ -313,7 +313,6 @@ struct damon_sysfs_scheme_filter {
 	struct kobject kobj;
 	enum damos_filter_type type;
 	bool matching;
-	bool pass;
 	char *memcg_path;
 	struct damon_addr_range addr_range;
 	int target_idx;
@@ -386,30 +385,6 @@ static ssize_t matching_store(struct kobject *kobj,
 	return count;
 }
 
-static ssize_t pass_show(struct kobject *kobj,
-		struct kobj_attribute *attr, char *buf)
-{
-	struct damon_sysfs_scheme_filter *filter = container_of(kobj,
-			struct damon_sysfs_scheme_filter, kobj);
-
-	return sysfs_emit(buf, "%c\n", filter->pass ? 'Y' : 'N');
-}
-
-static ssize_t pass_store(struct kobject *kobj,
-		struct kobj_attribute *attr, const char *buf, size_t count)
-{
-	struct damon_sysfs_scheme_filter *filter = container_of(kobj,
-			struct damon_sysfs_scheme_filter, kobj);
-	bool pass;
-	int err = kstrtobool(buf, &pass);
-
-	if (err)
-		return err;
-
-	filter->pass = pass;
-	return count;
-}
-
 static ssize_t memcg_path_show(struct kobject *kobj,
 		struct kobj_attribute *attr, char *buf)
 {
@@ -507,9 +482,6 @@ static struct kobj_attribute damon_sysfs_scheme_filter_type_attr =
 static struct kobj_attribute damon_sysfs_scheme_filter_matching_attr =
 		__ATTR_RW_MODE(matching, 0600);
 
-static struct kobj_attribute damon_sysfs_scheme_filter_pass_attr =
-		__ATTR_RW_MODE(pass, 0600);
-
 static struct kobj_attribute damon_sysfs_scheme_filter_memcg_path_attr =
 		__ATTR_RW_MODE(memcg_path, 0600);
 
@@ -525,7 +497,6 @@ static struct kobj_attribute damon_sysfs_scheme_filter_damon_target_idx_attr =
 static struct attribute *damon_sysfs_scheme_filter_attrs[] = {
 	&damon_sysfs_scheme_filter_type_attr.attr,
 	&damon_sysfs_scheme_filter_matching_attr.attr,
-	&damon_sysfs_scheme_filter_pass_attr.attr,
 	&damon_sysfs_scheme_filter_memcg_path_attr.attr,
 	&damon_sysfs_scheme_filter_addr_start_attr.attr,
 	&damon_sysfs_scheme_filter_addr_end_attr.attr,
@@ -1930,8 +1901,7 @@ static int damon_sysfs_add_scheme_filters(struct damos *scheme,
 			sysfs_filters->filters_arr[i];
 		struct damos_filter *filter =
 			damos_new_filter(sysfs_filter->type,
-					sysfs_filter->matching,
-					sysfs_filter->pass);
+					sysfs_filter->matching, false);
 		int err;
 
 		if (!filter)
-- 
2.39.5

