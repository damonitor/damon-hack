From: SeongJae Park <sj@kernel.org>
Date: Sun, 23 Nov 2025 08:52:16 -0800
Subject: [PATCH] ==== damos_stat nr_snapshots, max_nr_snapshots, tracepoint
 ====

mm/damos/stat: introduce nr_snapshots, max_nr_snapshots and tracepoint

Introduce three changes for improving DAMOS stat's provided information,
deterministic control, and reading usability.

DAMOS provides stats that important for understanding its behavior.  It
lacks information about how many DAMON-generated moniroting output
snapshots it has worked on.  Add a new stat, nr_snapshots, to show the
information.

Users can control DAMOS schemes in multiple ways.  Using the online
parameters commit feature, they can install and uninstall DAMOS schemes
whenever they want while keeping DAMON runs.  DAMOS quotas and
watermarks can be used for manually or automatically turning on/off or
adjust the aggressiveness of the scheme.  DAMOS filters can be used for
applying the scheme to specific memory entities based on their types and
locations.  Some users want their DAMOS scheme to be applied only
specific number of DAMON snapshots, for more deterministic control.  One
example use case is tracepoint based snapshot reading.  Add a new knob,
max_nr_snapshots, to support this.  If the nr_snapshots parameter be
same to or greaster than the value of this parameter, the scheme is
deactivated.

Users can read DAMOS stats via DAMON's sysfs interface.  For deep level
investigations on environments having advanced tools like perf and
bpftrace, exposing the stats via a tracepoint can be useful.  Implement
a new tracepoint, namely damon:damos_stat_after_apply_interval.

Signed-off-by: SeongJae Park <sj@kernel.org>
---
 hkml_cv_bogus/hkml_cv_bogus_5fjmwrl0 | 0
 1 file changed, 0 insertions(+), 0 deletions(-)
 create mode 100644 hkml_cv_bogus/hkml_cv_bogus_5fjmwrl0

diff --git a/hkml_cv_bogus/hkml_cv_bogus_5fjmwrl0 b/hkml_cv_bogus/hkml_cv_bogus_5fjmwrl0
new file mode 100644
index 000000000000..e69de29bb2d1
-- 
2.47.3

