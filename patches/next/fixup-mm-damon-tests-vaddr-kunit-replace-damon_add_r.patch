From: SeongJae Park <sj@kernel.org>
Date: Wed, 18 Feb 2026 20:59:38 -0800
Subject: [PATCH] fixup mm/damon/tests/vaddr-kunit: replace damon_add_region()
 with damon_set_regions()

Signed-off-by: SeongJae Park <sj@kernel.org>
---
 mm/damon/tests/vaddr-kunit.h | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/mm/damon/tests/vaddr-kunit.h b/mm/damon/tests/vaddr-kunit.h
index 232c5171d63bb..23be9c3be75fa 100644
--- a/mm/damon/tests/vaddr-kunit.h
+++ b/mm/damon/tests/vaddr-kunit.h
@@ -140,7 +140,7 @@ static void damon_do_test_apply_three_regions(struct kunit *test,
 	if (!t)
 		kunit_skip(test, "target alloc fail");
 
-	ranges = kmalloc_array(nr_regions, sizeof(*ranges), GFP_KERNEL);
+	ranges = kmalloc_array(nr_regions / 2, sizeof(*ranges), GFP_KERNEL);
 	if (!ranges) {
 		damon_destroy_target(t, NULL);
 		kunit_skip(test, "ranges alloc fail");
@@ -149,7 +149,7 @@ static void damon_do_test_apply_three_regions(struct kunit *test,
 		ranges[i].start = regions[i * 2];
 		ranges[i].end = regions[i * 2 + 1];
 	}
-	damon_set_regions(t, ranges, nr_regions, DAMON_MIN_REGION_SZ);
+	damon_set_regions(t, ranges, nr_regions / 2, DAMON_MIN_REGION_SZ);
 
 	damon_set_regions(t, three_regions, 3, DAMON_MIN_REGION_SZ);
 
-- 
2.47.3

