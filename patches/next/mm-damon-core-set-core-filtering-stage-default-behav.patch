From: SeongJae Park <sj@kernel.org>
Date: Wed, 26 Feb 2025 16:33:25 -0800
Subject: [PATCH] mm/damon/core: set core filtering stage default behavior as
 allow if ops filters exist

Signed-off-by: SeongJae Park <sj@kernel.org>
---
 mm/damon/core.c | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/mm/damon/core.c b/mm/damon/core.c
index 71b5e433b477..783cc05a9fcc 100644
--- a/mm/damon/core.c
+++ b/mm/damon/core.c
@@ -959,8 +959,11 @@ static bool damos_filters_default_reject(struct list_head *filters)
 
 static void damos_set_filters_default_reject(struct damos *s)
 {
-	s->core_filters_default_reject =
-		damos_filters_default_reject(&s->filters);
+	if (!list_empty(&s->ops_filters))
+		s->core_filters_default_reject = false;
+	else
+		s->core_filters_default_reject =
+			damos_filters_default_reject(&s->filters);
 	s->ops_filters_default_reject =
 		damos_filters_default_reject(&s->ops_filters);
 }
-- 
2.39.5

