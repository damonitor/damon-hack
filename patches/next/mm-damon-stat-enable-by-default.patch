From: SeongJae Park <sj@kernel.org>
Date: Wed, 14 May 2025 07:58:12 -0700
Subject: [PATCH] mm/damon/stat: enable by default

Signed-off-by: SeongJae Park <sj@kernel.org>
---
 mm/damon/Kconfig | 8 ++++++++
 mm/damon/stat.c  | 2 +-
 2 files changed, 9 insertions(+), 1 deletion(-)

diff --git a/mm/damon/Kconfig b/mm/damon/Kconfig
index 39d9897d3452..ce32f16a9868 100644
--- a/mm/damon/Kconfig
+++ b/mm/damon/Kconfig
@@ -103,6 +103,14 @@ config DAMON_STAT
 	  It runs DAMON and expose access monitoring results in simple stat
 	  metrics.
 
+config DAMON_STAT_ENABLED_DEFAULT
+	bool "Enable DAMON_STAT by default"
+	depends on DAMON_PADDR
+	default DAMON_STAT
+	help
+	  Whether to enable DAMON_STAT by default.  Users can disable it in
+	  boot or runtime using its 'enabled' parameter.
+
 config DAMON_ACMA
 	bool "Build Access/Contiguity-aware Memory Auto-scaling (DAMON_ACMA)"
 	depends on DAMON_PADDR
diff --git a/mm/damon/stat.c b/mm/damon/stat.c
index 796125d63b75..73028f64c97b 100644
--- a/mm/damon/stat.c
+++ b/mm/damon/stat.c
@@ -24,7 +24,7 @@ static const struct kernel_param_ops enabled_param_ops = {
 	.get = param_get_bool,
 };
 
-static bool enabled __read_mostly;
+static bool enabled __read_mostly = CONFIG_DAMON_STAT_ENABLED_DEFAULT;
 module_param_cb(enabled, &enabled_param_ops, &enabled, 0600);
 MODULE_PARM_DESC(enabled, "Enable of disable DAMON_STAT");
 
-- 
2.39.5

