From: SeongJae Park <sj@kernel.org>
Date: Mon, 27 Oct 2025 18:15:24 -0700
Subject: [PATCH] mm/damon/tests/core-kunit: handle alloc failure on
 damon_tests_set_attrs()

Fixes: aa13779be6b7 ("mm/damon/core-test: add a test for damon_set_attrs()")
Cc: <stable@vger.kernel.org> # 6.5.x
Signed-off-by: SeongJae Park <sj@kernel.org>
---
 mm/damon/tests/core-kunit.h | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/mm/damon/tests/core-kunit.h b/mm/damon/tests/core-kunit.h
index a805500867b4..083421bd8b52 100644
--- a/mm/damon/tests/core-kunit.h
+++ b/mm/damon/tests/core-kunit.h
@@ -448,6 +448,9 @@ static void damon_test_set_attrs(struct kunit *test)
 		.sample_interval = 5000, .aggr_interval = 100000,};
 	struct damon_attrs invalid_attrs;
 
+	if (!c)
+		kunit_skip(test, "ctx alloc fail");
+
 	KUNIT_EXPECT_EQ(test, damon_set_attrs(c, &valid_attrs), 0);
 
 	invalid_attrs = valid_attrs;
-- 
2.47.3

