From: SeongJae Park <sj@kernel.org>
Date: Sat, 10 Jan 2026 10:57:01 -0800
Subject: [PATCH] selftests/damon/wss_estimation: raise the bar again

Signed-off-by: SeongJae Park <sj@kernel.org>
---
 ...te_schemes_tried_regions_wss_estimation.py | 39 ++++++++++---------
 1 file changed, 21 insertions(+), 18 deletions(-)

diff --git a/tools/testing/selftests/damon/sysfs_update_schemes_tried_regions_wss_estimation.py b/tools/testing/selftests/damon/sysfs_update_schemes_tried_regions_wss_estimation.py
index 56a4c40e065f..079a628442be 100755
--- a/tools/testing/selftests/damon/sysfs_update_schemes_tried_regions_wss_estimation.py
+++ b/tools/testing/selftests/damon/sysfs_update_schemes_tried_regions_wss_estimation.py
@@ -22,25 +22,28 @@ def get_total_mem_bytes():
 
 def is_test_passed(wss_collected, expected_wss):
     wss_collected.sort()
-    percentile = 75
     nr_collections = len(wss_collected)
-    sample = wss_collected[int(nr_collections * percentile / 100)]
-    error_rate = abs(sample - expected_wss) / expected_wss
-    print('%d-th percentile (%d) error %f' %
-            (percentile, sample, error_rate))
-
-    acceptable_error_rate = 0.2
-    if error_rate < acceptable_error_rate:
-        return True
-
-    print('the error rate is not acceptable (> %f)' %
-            acceptable_error_rate)
-    for percentile in [0, 25, 50, 65, 75, 85, 95, 100]:
-        idx = min(int(nr_collections * percentile / 100), nr_collections - 1)
-        print('%3d-th percentile: %20d (error %f)' %
-              (percentile, wss_collected[idx],
-               abs(wss_collected[idx] - expected_wss) / expected_wss))
-    return False
+
+    for percentile in [50, 75]:
+        sample = wss_collected[int(nr_collections * percentile / 100)]
+        error_rate = abs(sample - expected_wss) / expected_wss
+        print('%d-th percentile (%d) error %f' %
+                (percentile, sample, error_rate))
+
+        acceptable_error_rate = 0.2
+        if error_rate < acceptable_error_rate:
+            continue
+
+        print('the error rate is not acceptable (> %f)' %
+                acceptable_error_rate)
+        for percentile in [0, 25, 50, 65, 75, 85, 95, 100]:
+            idx = min(int(nr_collections * percentile / 100),
+                      nr_collections - 1)
+            print('%3d-th percentile: %20d (error %f)' %
+                  (percentile, wss_collected[idx],
+                   abs(wss_collected[idx] - expected_wss) / expected_wss))
+        return False
+    return True
 
 def main():
     total_mem_bytes, err = get_total_mem_bytes()
-- 
2.47.3

