From hackermail Thu Jan  1 00:00:00 1970
From: SeongJae Park <sj@kernel.org>
To: Andrew Morton <akpm@linux-foundation.org>
Cc: SeongJae Park <sj@kernel.org>, damon@lists.linux.dev, kernel-team@meta.com, linux-kernel@vger.kernel.org, linux-mm@kvack.org
Message-Id: <20250916183127.65708-1-sj@kernel.org>
Date: Tue, 16 Sep 2025 11:31:25 -0700
Subject: [PATCH 0/2] mm/damon/stat: expose auto-tuned intervals and non-idle ages

DAMON_STAT is intentionally providing limited information for easy
consumption of the information.  From production fleet level usages,
below limitations are found, though.

The aggregation interval of DAMON_STAT represents the granularity of the
memory_idle_ms_percentiles.  But the interval is auto-tuned and not
exposed to users, so users cannot know the granularity.

All memory regions of non-zero (positive) nr_accesses are treated as
having zero idle time.  A significant portion of production systems have
such zero idle time.  Hence breakdown of warm and hot data is nearly
impossible.

Make following changes to overcome the limitations.  Expose the
auto-tuned aggregation interval with a new parameter named
aggr_interval_us.  Expose the age of non-zero nr_accesses (how long >0
access frequency the region retained) regions as a negative idle time.

Changes from RFC
(https://lore.kernel.org/20250910040022.168223-1-sj@kernel.org)
- Rebase on latest mm-new
- Wordsmith commit messages

SeongJae Park (2):
  mm/damon/stat: expose the current tuned aggregation interval
  mm/damon/stat: expose negative idle time

 mm/damon/stat.c | 16 +++++++++++-----
 1 file changed, 11 insertions(+), 5 deletions(-)


base-commit: ae4745146347aef91dc328d1d9a39f0643ee244d
-- 
2.39.5