From hackermail Thu Jan  1 00:00:00 1970
From: SeongJae Park <sj@kernel.org>
To: Andrew Morton <akpm@linux-foundation.org>
Cc: SeongJae Park <sj@kernel.org>
Cc: damon@lists.linux.dev
Cc: linux-kernel@vger.kernel.org
Cc: linux-mm@kvack.org
Date: Sat, 17 Jan 2026 09:52:00 -0800
Subject: [PATCH 0/8] mm/damon: cleanup kdamond, damon_call(), damos filter and DAMON_MIN_REGION

Do miscellaneous code cleanups for improving readability.  First three
patches cleanup kdamond termination process, by removing unused
operation set cleanup callback (patch 1) and moving damon_ctx specific
resource cleanups on kdamond termination to synchronization-easy place
(patches 2 and 3).  Next two patches touch damon_call() infrastructure,
by refactoring kdamond_call() function to do less and simpler locking
operations (patch 4), and documenting when dealloc_on_free does work
(patch 5).  Final three patches rename things for clear uses of those.
Those rename damos_filter_out() to be more explicit about the fact that
it is only for core-handled filters (patch 6), DAMON_MIN_REGION macro to
be more explicit it is not about number of regions but size of each
region (patch 7), and damon_ctx->min_sz_region to be different from
damos_access_patern->min_sz_region (patch 8), so that those are not
confusing and easy to grep.

SeongJae Park (8):
  mm/damon: remove damon_operations->cleanup()
  mm/damon/core: cleanup targets and regions at once on kdamond
    termination
  mm/damon/core: cancel damos_walk() before damon_ctx->kdamond reset
  mm/damon/core: process damon_call_control requests on a local list
  mm/damon: document damon_call_control->dealloc_on_cancel repeat
    behavior
  mm/damon/core: rename damos_filter_out() to damos_core_filter_out()
  mm/damon: rename DAMON_MIN_REGION to DAMON_MIN_REGION_SZ
  mm/damon: rename min_sz_region of damon_ctx to min_region_sz

 include/linux/damon.h        |  15 ++--
 mm/damon/core.c              | 143 +++++++++++++++--------------------
 mm/damon/lru_sort.c          |   4 +-
 mm/damon/paddr.c             |   1 -
 mm/damon/reclaim.c           |   4 +-
 mm/damon/stat.c              |   2 +-
 mm/damon/sysfs.c             |  11 +--
 mm/damon/tests/vaddr-kunit.h |   2 +-
 mm/damon/vaddr.c             |  25 +++---
 9 files changed, 89 insertions(+), 118 deletions(-)


base-commit: 886ef5515d08f05191b61a347fc18f371627bdd4
-- 
2.47.3
